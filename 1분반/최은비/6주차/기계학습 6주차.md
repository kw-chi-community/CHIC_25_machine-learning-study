# ê¸°ê³„í•™ìŠµ 6ì£¼ì°¨

# **06-1 êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜**

- **í‘ë°± ê³¼ì¼ ì‚¬ì§„ì„ êµ°ì§‘í™”í•˜ì—¬ ìë™ ë¶„ë¥˜í•˜ëŠ” ê³¼ì •**ì„ ë‹¤ë£¬ë‹¤.
- **ë¹„ì§€ë„ í•™ìŠµ(unsupervised learning)ê³¼ êµ°ì§‘(Clustering) ì•Œê³ ë¦¬ì¦˜**ì„ ì´í•´í•œë‹¤.

---

## **1. ë¹„ì§€ë„ í•™ìŠµì´ë€?**

- **íƒ€ê²Ÿ(ì •ë‹µ) ë°ì´í„° ì—†ì´** íŒ¨í„´ì„ ì°¾ì•„ ê·¸ë£¹ì„ í˜•ì„±í•˜ëŠ” ê¸°ë²•
- ëŒ€í‘œì ì¸ ë°©ë²•: **êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜(Clustering Algorithm)**
- **K-í‰ê· (K-Means), ê³„ì¸µ êµ°ì§‘(Hierarchical Clustering), DBSCAN** ë“±ì´ ìˆìŒ

**â†’ êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•˜ë©´ ì‚¬ëŒì´ ì§ì ‘ ë¶„ë¥˜í•˜ì§€ ì•Šì•„ë„ ë°ì´í„°ì˜ íŒ¨í„´ì„ ë¶„ì„í•˜ì—¬ ìë™ìœ¼ë¡œ ê·¸ë£¹ì„ ë§Œë“¤ ìˆ˜ ìˆìŒ.**

---

## **2. ê³¼ì¼ ì‚¬ì§„ ë°ì´í„° ì¤€ë¹„í•˜ê¸°**

ê³¼ì¼ ì‚¬ì§„ ë°ì´í„°ì…‹ì—ëŠ” **ì‚¬ê³¼, ë°”ë‚˜ë‚˜, íŒŒì¸ì• í”Œ**ì´ í¬í•¨ë˜ì–´ ìˆìŒ.

ë°ì´í„°ëŠ” **í‘ë°± ì´ë¯¸ì§€(100 Ã— 100 í¬ê¸°)ë¡œ ì €ì¥ëœ `.npy` íŒŒì¼**ë¡œ ì œê³µë¨.

### **ë°ì´í„° ë‹¤ìš´ë¡œë“œ**

```python
!wget https://bit.ly/fruits_300_data -O fruits_300.npy
```

- `wget` ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ `.npy` íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•œë‹¤.

---

## **ğŸ“Œ 3. ë°ì´í„° ë¡œë“œ ë° í™•ì¸í•˜ê¸°**

### **numpyë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°**

```python
import numpy as np
import matplotlib.pyplot as plt

# ë°ì´í„° ë¡œë“œ
fruits = np.load('fruits_300.npy')

# ë°ì´í„° í¬ê¸° í™•ì¸
print(fruits.shape)
```

**ì¶œë ¥ ì˜ˆì‹œ**

```python
(300, 100, 100)
```

â†’ 300ê°œì˜ ìƒ˜í”Œì´ ìˆê³ , ê° ì´ë¯¸ì§€ì˜ í¬ê¸°ëŠ” **100 Ã— 100 í”½ì…€**

---

## **4. ì²« ë²ˆì§¸ ì´ë¯¸ì§€ ì¶œë ¥í•˜ê¸°**

```python
plt.imshow(fruits[0], cmap='gray')
plt.show()

```

ì¶œë ¥ ê²°ê³¼ : ì²« ë²ˆì§¸ ì´ë¯¸ì§€(**ì‚¬ê³¼)**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.04.30.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.04.30.png)

**í”½ì…€ ê°’ í™•ì¸**

```python
print(fruits[0, 0, :])

[ 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1
  2 2 2 2 2 2 1 1 1 1 1 1 1 1 2 3 2 1
  2 1 1 1 1 2 1 3 2 1 3 1 4 1 2 5 5 5
  19 148 192 117 28 1 1 2 1 4 1 1 3 1 1 1 1 1
  2 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
  1 1 1 1 1 1 1 1 1 1 ]
```

â†’ ì´ë¯¸ì§€ì˜ ì²« ë²ˆì§¸ í–‰ì˜ í”½ì…€ ê°’ì´ ì¶œë ¥ë¨ (0~255 ë²”ìœ„ì˜ ê°’)

---

## **5. ì—¬ëŸ¬ ì´ë¯¸ì§€ ë¹„êµí•˜ê¸°**

```python
plt.imshow(fruits[0], cmap='gray_r')
plt.show
```

ì¶œë ¥ ê²°ê³¼ : 

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.06.06.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.06.06.png)

```python
fig, axs = plt.subplots(1, 2)
axs[0].imshow(fruits[100], cmap='gray_r')  # íŒŒì¸ì• í”Œ
axs[1].imshow(fruits[200], cmap='gray_r')  # ë°”ë‚˜ë‚˜
plt.show()
```

**ì¶œë ¥ ê²°ê³¼ :** ì‚¬ê³¼, íŒŒì¸ì• í”Œ, ë°”ë‚˜ë‚˜ ì´ë¯¸ì§€ê°€ ì¶œë ¥ë¨.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.06.39.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.06.39.png)

---

## **6. í”½ì…€ ê°’ ë¶„ì„í•˜ê¸°**

í”½ì…€ ê°’ì˜ í‰ê· ì„ ê³„ì‚°í•˜ì—¬ íŠ¹ì§•ì„ ì¶”ì¶œí•œë‹¤.

ê° ì´ë¯¸ì§€ë¥¼ 1ì°¨ì› ë²¡í„°(10,000ê°œ í”½ì…€)ë¡œ ë³€í™˜í•œë‹¤.

### **ì´ë¯¸ì§€ ë°ì´í„° ë³€í™˜**

```python
apple = fruits[0:100].reshape(-1, 100*100)  # ì‚¬ê³¼
pineapple = fruits[100:200].reshape(-1, 100*100)  # íŒŒì¸ì• í”Œ
banana = fruits[200:300].reshape(-1, 100*100)  # ë°”ë‚˜ë‚˜

print(apple.shape)  # (100, 10000)
```

**ì¶œë ¥ ê²°ê³¼**

```python
(100, 10000)
```

â†’ 100ê°œì˜ ìƒ˜í”Œì´ ê°ê° **10,000ê°œ í”½ì…€ë¡œ ë³€í™˜ë¨**

---

## **7. í‰ê·  í”½ì…€ ê°’ ê³„ì‚°**

```python
print(apple.mean(axis=1))
```

**ì¶œë ¥ ê²°ê³¼** (ê° ìƒ˜í”Œì˜ í‰ê· ê°’)

```python
[ 88.3346 97.9249 87.3709 98.3703 92.8705 82.6439 94.4244 95.5999
  90.681 81.6226 87.0578 95.0745 93.8416 87.017 97.507 87.2019
  88.9827 100.9158 92.7823 100.9184 104.9854 88.674 99.5643 97.2495
  94.1179 92.1935 95.1671 93.3322 102.8967 94.6695 90.5285 89.0744
  97.7641 97.2938 100.7564 90.5236 100.2542 85.8452 96.4615 97.1492
  90.711 102. 3193 87. 1629 89.8751 86.7327 86.3991 95.2865 89. 1709
  96.8163 91.6604 96. 1065 99.6829 94.9718 87.4812 89.2596 89.5268
  93.799 97.3983 87.151 97.825 103.22 94.4239 83.6657 83.5159
  102.8453 87.0379 91.2742 100.4848 93.8388 90.8568 97.4616 97.5022
  82.446 87.1789 96.9206 90.3135 90.565 97.6538 98.0919 93.6252
  87.3867 84.7073 89.1135 86.7646 88.7301 86.643 96.7323 97.2604
  81.9424 87.1687 97.2066 83.4712 95.9781 91.8096 98.4086 100.7823
  101.556 100.7027 91.6098 88.8976]
```

â†’ **ì‚¬ê³¼ í”½ì…€ ê°’ì€ í‰ê· ì ìœ¼ë¡œ 90~100 ì‚¬ì´**

**íˆìŠ¤í† ê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ë¶„í¬ ì‹œê°í™”**

```python
plt.hist(np.mean(apple, axis=1), alpha=0.8)
plt.hist(np.mean(pineapple, axis=1), alpha=0.8)
plt.hist(np.mean(banana, axis=1), alpha=0.8)
plt.legend(['apple', 'pineapple', 'banana'])
plt.show()
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.31.25.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.31.25.png)

â†’ **ì‚¬ê³¼ëŠ” 90~100 ë°”ë‚˜ë‚˜ëŠ” 40 ì´í•˜, íŒŒì¸ ì• í”Œì€ 90~100 ì‚¬ì´**

â†’ í”½ì…€ ê°’ì˜ í‰ê· ì„ ë³´ë©´ **ì‚¬ê³¼ì™€ íŒŒì¸ì• í”Œì´ ë¹„ìŠ·í•˜ê³  ë°”ë‚˜ë‚˜ëŠ” í™•ì—°íˆ ë‹¤ë¦„**

```python
fig, axs = plt.subplots(1, 3, figsize=(20,5))
axs[0]. bar(range(10000), np.mean(apple, axis=0))
axs[1].bar (range(10000), np.mean(pineapple, axis=0))
axs [2].bar (range(10000), np.mean (banana, axis=0))
plt.show()
```

ì¶œë ¥ ê²°ê³¼

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.36.02.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.36.02.png)

â†’ ìˆœì„œëŒ€ë¡œ ì‚¬ê³¼, íŒŒì¸ì• í”Œ, ë°”ë‚˜ë‚˜ ê·¸ë˜í”„ì„

â†’ 3ê°œì˜ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ê³¼ì¼ë§ˆë‹¤ ê°’ì´ ë†’ì€ êµ¬ê°„ì´ ë‹¤ë¦„

---

## **8. í‰ê· ê°’ê³¼ ê°€ê¹Œìš´ ì‚¬ì§„ ì°¾ê¸°**

```python
apple_mean = np.mean(apple, axis=0).reshape(100, 100)
pineapple_mean = np.mean(pineapple, axis=0).reshape(100, 100)
banana_mean = np.mean(banana, axis=0).reshape(100, 100)

fig, axs = plt.subplots(1, 3, figsize=(20, 5))
axs[0].imshow(apple_mean, cmap='gray_r')
axs[1].imshow(pineapple_mean, cmap='gray_r')
axs[2].imshow(banana_mean, cmap='gray_r')
plt.show()
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.37.56.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.37.56.png)

â†’ ê° ê³¼ì¼ì˜ í‰ê·  ì´ë¯¸ì§€ë¥¼ í™•ì¸ ê°€ëŠ¥

---

## **9. í‰ê· ê°’ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ì‚¬ì§„ ì°¾ê¸°**

```python
abs_diff = np.abs(fruits - apple_mean)
abs_mean = np.mean(abs_diff, axis=(1, 2))

print(abs_mean.shape)  # (300,)
```

**ì¶œë ¥ ê²°ê³¼**

```python
(300,)
```

â†’ ê° ìƒ˜í”Œì˜ í‰ê· ê³¼ ì–¼ë§ˆë‚˜ ì°¨ì´ê°€ ë‚˜ëŠ”ì§€ ê³„ì‚°

**ê°€ì¥ ê°€ê¹Œìš´ 100ê°œ ìƒ˜í”Œ ì°¾ê¸°**

```python
apple_index = np.argsort(abs_mean)[:100]  # ê°€ì¥ ê°€ê¹Œìš´ 100ê°œ ìƒ˜í”Œ ì„ íƒ

fig, axs = plt.subplots(10, 10, figsize=(10, 10))
for i in range(10):
    for j in range(10):
        axs[i, j].imshow(fruits[apple_index[i*10 + j]], cmap='gray_r')
        axs[i, j].axis('off')
plt.show()
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 1.38.34.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_1.38.34.png)

â†’ **ê°€ì¥ ê°€ê¹Œìš´ 100ê°œì˜ ì‚¬ê³¼ ì´ë¯¸ì§€ë¥¼ ìë™ìœ¼ë¡œ ì°¾ìŒ**

---

# **06-2 k-í‰ê· (K-Means)**

- **ë¹„ì§€ë„ í•™ìŠµì„ ì´ìš©í•´ ê³¼ì¼ ì‚¬ì§„ì„ ìë™ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” ëª¨ë¸ì„ ë§Œë“ ë‹¤.**
- **K-í‰ê·  êµ°ì§‘í™”(K-Means Clustering) ì•Œê³ ë¦¬ì¦˜ì„ ì´í•´í•˜ê³  êµ¬í˜„í•œë‹¤.**

---

## **1. K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ ì†Œê°œ**

- *K-í‰ê· (K-Means)**ì€ ë°ì´í„°ë¥¼ **Kê°œì˜ ê·¸ë£¹(í´ëŸ¬ìŠ¤í„°)**ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” êµ°ì§‘ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.

ì´ ê³¼ì •ì—ì„œ ê° í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬ì„ **í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬(centroid)**ì´ë¼ê³  í•œë‹¤.

### **K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ ë™ì‘ ê³¼ì •**

1. **ë¬´ì‘ìœ„ë¡œ Kê°œì˜ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì„¤ì •**
2. ê° ë°ì´í„° ìƒ˜í”Œì„ **ê°€ì¥ ê°€ê¹Œìš´ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì— í• ë‹¹**
3. í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ìƒˆë¡­ê²Œ ì—…ë°ì´íŠ¸
4. **í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì´ ë” ì´ìƒ ë³€í™”í•˜ì§€ ì•Šì„ ë•Œê¹Œì§€ 2~3 ê³¼ì •ì„ ë°˜ë³µ**
- **ë°˜ë³µ(iteration)**ì„ í†µí•´ ìµœì ì˜ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì„ ì°¾ëŠ”ë‹¤.
- **K-í‰ê· ì€ ë°˜ë³µí• ìˆ˜ë¡ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì´ ì ì  ë” ì •í™•í•´ì§„ë‹¤.**

---

## **2. ë°ì´í„° ì¤€ë¹„í•˜ê¸°**

ê³¼ì¼ ì‚¬ì§„ ë°ì´í„°ëŠ” **300ê°œ í‘ë°± ì´ë¯¸ì§€(100Ã—100 í¬ê¸°)**ë¡œ ì œê³µë¨.

ìš°ë¦¬ëŠ” **K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ê³¼, ë°”ë‚˜ë‚˜, íŒŒì¸ì• í”Œì„ ìë™ìœ¼ë¡œ ë¶„ë¥˜**í•  ê²ƒì´ë‹¤.

**ë°ì´í„° ë‹¤ìš´ë¡œë“œ ë° ë¡œë“œ**

```bash
!wget https://bit.ly/fruits_300_data -O fruits_300.npy
```

```python
import numpy as np

# npy íŒŒì¼ ë¡œë“œ
fruits = np.load('fruits_300.npy')

# 2ì°¨ì› ë°°ì—´ë¡œ ë³€í™˜ (ìƒ˜í”Œ ê°œìˆ˜, í”½ì…€ ìˆ˜)
fruits_2d = fruits.reshape(-1, 100*100)
```

â†’ **ê° ì´ë¯¸ì§€ë¥¼ 1ì°¨ì› ë²¡í„°(10,000í”½ì…€)ë¡œ ë³€í™˜í•˜ì—¬ K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì— ì ìš©í•  ì¤€ë¹„ ì™„ë£Œ!**

```python
from sklear.cluster import Keans
â€¹m = KMeans(n_clusters=3, random_state=42)
km. fit(fruits_2d)
```

---

## **3. K-í‰ê·  í´ëŸ¬ìŠ¤í„°ë§ ì ìš©**

```python
from sklearn.cluster import KMeans

# K-í‰ê·  ëª¨ë¸ ìƒì„± (í´ëŸ¬ìŠ¤í„° ê°œìˆ˜: 3ê°œ)
km = KMeans(n_clusters=3, random_state=42)

# ë°ì´í„°ì— ëª¨ë¸ ì ìš© (í›ˆë ¨)
km.fit(fruits_2d)
```

- **K-í‰ê·  ëª¨ë¸ì´ 3ê°œì˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ìë™ìœ¼ë¡œ ì°¾ìŒ.**
- **ê° ìƒ˜í”Œì´ ì–´ëŠ í´ëŸ¬ìŠ¤í„°ì— ì†í•˜ëŠ”ì§€ `km.labels_`ì— ì €ì¥ë¨.**

---

## **4. í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ í™•ì¸**

```python
print(km.labels_)  # ê° ìƒ˜í”Œì˜ í´ëŸ¬ìŠ¤í„° í• ë‹¹ ê²°ê³¼ ì¶œë ¥
print(np.unique(km.labels_, return_counts=True))  # í´ëŸ¬ìŠ¤í„°ë³„ ìƒ˜í”Œ ê°œìˆ˜ í™•ì¸
```

**ì¶œë ¥ ì˜ˆì‹œ**

```python
[ 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 20 0 0 0 0 0 0 0 2 0 2 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 2 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0 0 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 11 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 ]
```

```python
(array([0, 1, 2]), array([ 91,  98, 111]))
```

â†’ **0ë²ˆ í´ëŸ¬ìŠ¤í„°: 91ê°œ, 1ë²ˆ í´ëŸ¬ìŠ¤í„°: 98ê°œ, 2ë²ˆ í´ëŸ¬ìŠ¤í„°: 111ê°œ ìƒ˜í”Œì´ ì†í•¨**

---

## **5. í´ëŸ¬ìŠ¤í„°ë³„ ì´ë¯¸ì§€ ì‹œê°í™”**

```python
import matplotlib.pyplot as plt

def draw_fruits(arr, ratio=1):
    n = len(arr)  # ìƒ˜í”Œ ê°œìˆ˜
    rows = int(np.ceil(n / 10))  # 10ê°œì”© í–‰ì„ ë‚˜ëˆ”
    cols = min(10, n)  # ìµœëŒ€ 10ê°œ ì»¬ëŸ¼
    fig, axs = plt.subplots(rows, cols, figsize=(cols * ratio, rows * ratio))

    for i in range(rows):
        for j in range(cols):
            if i * 10 + j < n:
                axs[i, j].imshow(arr[i * 10 + j], cmap='gray_r')
                axs[i, j].axis('off')

    plt.show()
```

- **í´ëŸ¬ìŠ¤í„°ë³„ ì´ë¯¸ì§€ë¥¼ ê·¸ë¦¬ëŠ” í•¨ìˆ˜ ìƒì„±**
- ìƒ˜í”Œ ê°œìˆ˜ì— ë”°ë¼ **í–‰/ì—´ì„ ìë™ìœ¼ë¡œ ì¡°ì ˆí•˜ì—¬ ì‹œê°í™”**

---

## **6. í´ëŸ¬ìŠ¤í„°ë³„ ì´ë¯¸ì§€ ì¶œë ¥**

```python
draw_fruits(fruits[km.labels_ == 0])  # 0ë²ˆ í´ëŸ¬ìŠ¤í„° ìƒ˜í”Œ ì¶œë ¥
draw_fruits(fruits[km.labels_ == 1])  # 1ë²ˆ í´ëŸ¬ìŠ¤í„° ìƒ˜í”Œ ì¶œë ¥
draw_fruits(fruits[km.labels_ == 2])  # 2ë²ˆ í´ëŸ¬ìŠ¤í„° ìƒ˜í”Œ ì¶œë ¥
```

**ì¶œë ¥ ê²°ê³¼**

- **0ë²ˆ í´ëŸ¬ìŠ¤í„° â†’ ì‚¬ê³¼**
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.05.18.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.05.18.png)
    
- **1ë²ˆ í´ëŸ¬ìŠ¤í„° â†’ ë°”ë‚˜ë‚˜**
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.06.01.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.06.01.png)
    
- **2ë²ˆ í´ëŸ¬ìŠ¤í„° â†’ íŒŒì¸ì• í”Œ**
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.06.16.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.06.16.png)
    

**K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì´ ìë™ìœ¼ë¡œ ê³¼ì¼ì„ ë¶„ë¥˜í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ!**

---

## **7. í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ í™•ì¸**

```python
draw_fruits(km.cluster_centers_.reshape(-1, 100, 100), ratio=3)
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.06.41.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.06.41.png)

- K-í‰ê· ì´ ìµœì¢…ì ìœ¼ë¡œ ì°¾ì€ **3ê°œì˜ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬(centroids) ì¶œë ¥**
- ê° í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì´ **ì‚¬ê³¼, ë°”ë‚˜ë‚˜, íŒŒì¸ì• í”Œì˜ í‰ê·  ì´ë¯¸ì§€ì²˜ëŸ¼ ë³´ì„**

---

## **8. ìƒˆë¡œìš´ ì´ë¯¸ì§€ ì˜ˆì¸¡í•˜ê¸°**

```python
print(km. transform(fruits_2d[100:101]))
print(km.predict(fruits_2d[100:101]))  # 100ë²ˆì§¸ ì´ë¯¸ì§€ì˜ í´ëŸ¬ìŠ¤í„° ì˜ˆì¸¡
```

**ì¶œë ¥ ì˜ˆì‹œ**

```python
[[5267.70439881 8837.37750892 3393.8136117 ]]
[2]
```

â†’ **100ë²ˆì§¸ ê³¼ì¼ì€ 2ë²ˆ í´ëŸ¬ìŠ¤í„°(íŒŒì¸ì• í”Œ)ë¡œ ë¶„ë¥˜ë¨!

ìƒ˜í”Œ í™•ì¸**

```python
draw_fruits(fruits[100: 101])
```

ì¶œë ¥ ê²°ê³¼ : 

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.08.39.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.08.39.png)

ì•Œê³ ë¦¬ì¦˜ì˜ ë°˜ë³µ íšŸìˆ˜(n_*iter* ì†ì„±ì— ì €ì¥)

```python
print(km.n_iter_)
```

ì¶œë ¥ ê²°ê³¼ : 

```python
3
```

---

## **9. ìµœì ì˜ K ì°¾ê¸° (ì—˜ë³´ìš° ë°©ë²•)**

K-í‰ê·  ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•  ë•Œ **ì ì ˆí•œ K ê°’(í´ëŸ¬ìŠ¤í„° ê°œìˆ˜)ì„ ì°¾ëŠ” ê²ƒì´ ì¤‘ìš”**í•˜ë‹¤.

ì´ë¥¼ ìœ„í•´ **ì—˜ë³´ìš° ë°©ë²•(Elbow Method)**ì„ ì‚¬ìš©í•œë‹¤.

**ì—˜ë³´ìš° ë°©ë²• ì ìš©**

```python
inertia = []

for k in range(2, 7):  # K=2~6ê¹Œì§€ ë°˜ë³µ
    km = KMeans(n_clusters=k, random_state=42)
    km.fit(fruits_2d)
    inertia.append(km.inertia_)  # ì´ë„ˆì…”(inertia) ì €ì¥

# ê²°ê³¼ ì‹œê°í™”
plt.plot(range(2, 7), inertia)
plt.xlabel('k')
plt.ylabel('inertia')
plt.show()
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.12.41.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.12.41.png)

- **ì´ë„ˆì…”(Inertia)**: í´ëŸ¬ìŠ¤í„° ë‚´ ë°ì´í„°ë“¤ì´ ì¤‘ì‹¬ì—ì„œ ì–¼ë§ˆë‚˜ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ ë‚˜íƒ€ë‚´ëŠ” ê°’
- ê·¸ë˜í”„ì—ì„œ **ì´ë„ˆì…”ê°€ ê¸‰ê²©íˆ ê°ì†Œí•˜ëŠ” ì§€ì ì´ ìµœì ì˜ K ê°’**

**K=3ì—ì„œ ì´ë„ˆì…” ê°ì†Œ í­ì´ ì¤„ì–´ë“œëŠ” ê²ƒì„ í™•ì¸ â†’ K=3ì´ ìµœì ì˜ ê°’ìœ¼ë¡œ ë³´ì„!**

---

# **06-3 ì£¼ì„±ë¶„ ë¶„ì„ (PCA)**

- **ì°¨ì› ì¶•ì†Œ(Dimensionality Reduction)ì˜ ê°œë…ì„ ì´í•´í•˜ê³  PCAë¥¼ í™œìš©í•˜ì—¬ ë°ì´í„° ì°¨ì›ì„ ì¤„ì´ëŠ” ë°©ë²•ì„ ë°°ìš´ë‹¤.**
- **PCAë¥¼ í™œìš©í•´ ë°ì´í„° ì €ì¥ ê³µê°„ì„ ì ˆì•½í•˜ê³ , ëª¨ë¸ í•™ìŠµ ì†ë„ë¥¼ ë†’ì´ëŠ” ë°©ë²•ì„ ì‹¤ìŠµí•œë‹¤.**

---

## **1. ì°¨ì›ê³¼ ì°¨ì› ì¶•ì†Œ ê°œë…**

- **ì°¨ì›(Dimension)**: ë°ì´í„°ê°€ ê°€ì§„ íŠ¹ì„±(Feature)ì˜ ê°œìˆ˜
- **ì°¨ì› ì¶•ì†Œ(Dimensionality Reduction)**:
    - ë°ì´í„°ì˜ ì°¨ì›ì„ ì¤„ì—¬ ì €ì¥ ê³µê°„ì„ ì ˆì•½í•˜ê³ , í•™ìŠµ ì†ë„ë¥¼ í–¥ìƒì‹œí‚¤ëŠ” ë°©ë²•
    - ì¤‘ìš”í•œ ì •ë³´ëŠ” ìœ ì§€í•˜ë©´ì„œ ë¶ˆí•„ìš”í•œ ì •ë³´ëŠ” ì œê±°
- **ì˜ˆì œ: ê³¼ì¼ ì‚¬ì§„ ë°ì´í„°**
    - ì›ë³¸ ë°ì´í„°: **10,000ê°œ í”½ì…€(100Ã—100 í¬ê¸°ì˜ ì´ë¯¸ì§€)**
    - ì°¨ì› ì¶•ì†Œ í•„ìš”: **10,000ê°œ ì°¨ì›ì„ ìœ ì§€í•˜ëŠ” ê²ƒì€ ë¹„íš¨ìœ¨ì **
    - *ì£¼ì„±ë¶„ ë¶„ì„(PCA)**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¨ì›ì„ ì¤„ì´ë©´ì„œ ì •ë³´ ì†ì‹¤ì„ ìµœì†Œí™”

---

## **2. ì£¼ì„±ë¶„ ë¶„ì„(PCA) ê°œë…**

- **PCA (Principal Component Analysis, ì£¼ì„±ë¶„ ë¶„ì„)**
    - *ë°ì´í„°ì˜ ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥(ì£¼ì„±ë¶„)**ì„ ì°¾ì•„ ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì¶•ìœ¼ë¡œ ë³€í™˜
    - ë³€í™˜ëœ ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ **ê°€

ì¥ ì¤‘ìš”í•œ íŠ¹ì§•ì„ ìœ ì§€í•˜ë©´ì„œ ì°¨ì›ì„ ì¤„ì„**

**PCAì˜ í•µì‹¬ ê°œë…**

1. **ë°ì´í„°ì˜ ê°€ì¥ í° ë¶„ì‚° ë°©í–¥(ì£¼ì„±ë¶„)ì„ ì°¾ëŠ”ë‹¤.**
2. **ìƒˆë¡œìš´ ì¢Œí‘œê³„(ì£¼ì„±ë¶„ ì¶•)ë¡œ ë°ì´í„°ë¥¼ ë³€í™˜í•œë‹¤.**
3.  **ê°€ì¥ ì¤‘ìš”í•œ ì£¼ì„±ë¶„ë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ëŠ” ë²„ë ¤ ì°¨ì›ì„ ì¶•ì†Œí•œë‹¤.**
- **ì£¼ì„±ë¶„ ì¶•ì€ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ê°€ì¥ ì˜ í‘œí˜„í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì„¤ì •ë¨**
- **ì°¨ì› ì¶•ì†Œ í›„ì—ë„ ì›ë³¸ ë°ì´í„°ì˜ ì •ë³´ë¥¼ ìµœëŒ€í•œ ë³´ì¡´í•˜ë„ë¡ ì„¤ê³„**

---

## **3. PCAë¥¼ í™œìš©í•œ ë°ì´í„° ì°¨ì› ì¶•ì†Œ ì‹¤ìŠµ**

### **1) ë°ì´í„° ë‹¤ìš´ë¡œë“œ ë° ë¡œë“œ**

```bash
!wget https://bit.ly/fruits_300_data -O fruits_300.npy
```

```python
import numpy as np
import matplotlib.pyplot as plt

# npy íŒŒì¼ ë¡œë“œ
fruits = np.load('fruits_300.npy')

# 2ì°¨ì› ë°°ì—´ë¡œ ë³€í™˜ (ìƒ˜í”Œ ê°œìˆ˜, í”½ì…€ ìˆ˜)
fruits_2d = fruits.reshape(-1, 100*100)
```

â†’ **ê° ì´ë¯¸ì§€ë¥¼ 10,000í”½ì…€ì˜ 1ì°¨ì› ë²¡í„°ë¡œ ë³€í™˜í•˜ì—¬ PCAì— ì ìš©í•  ì¤€ë¹„ ì™„ë£Œ!**

---

### **2) PCA ëª¨ë¸ ì ìš© (50ê°œ ì£¼ì„±ë¶„ ì„ íƒ)**

```python
from sklearn.decomposition import PCA

# PCA ì ìš© (ì£¼ì„±ë¶„ ê°œìˆ˜: 50ê°œ)
pca = PCA(n_components=50)
pca.fit(fruits_2d)
```

**PCA ëª¨ë¸ì´ ê°€ì¥ ì¤‘ìš”í•œ 50ê°œì˜ ì£¼ì„±ë¶„(Principal Components)ì„ í•™ìŠµ**

```python
print(pca.components_.shape)  # (50, 10000)
```

**ì¶œë ¥ ê²°ê³¼**

```python
(50, 10000)
```

â†’ **10,000ê°œì˜ í”½ì…€ì„ 50ê°œì˜ ì£¼ì„±ë¶„ìœ¼ë¡œ ì••ì¶• ì™„ë£Œ!**

**ê·¸ë¦¼ ê·¸ë¦¬ê¸°**

```python
draw_fruits(pca.components_.reshape(-1, 100, 100))
```

**ì¶œë ¥ ê²°ê³¼ :** 

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.35.28.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.35.28.png)

---

### **4) ë°ì´í„° ì°¨ì› ì¶•ì†Œ**

```python
print(fruits_2d.shape)   # (300, 10000)
```

```python
# ì›ë³¸ ë°ì´í„°ë¥¼ PCAë¡œ ë³€í™˜ (ì°¨ì› ì¶•ì†Œ)
fruits_pca = pca.transform(fruits_2d)

print(fruits_pca.shape)  # (300, 50)
```

**ì¶œë ¥ ê²°ê³¼**

```python
(300, 50)
```

â†’ **10,000ì°¨ì›ì˜ ë°ì´í„°ê°€ 50ì°¨ì›ìœ¼ë¡œ ì¤„ì–´ë“¦!**

- **ì €ì¥ ê³µê°„ ì ˆì•½ & ëª¨ë¸ í•™ìŠµ ì†ë„ í–¥ìƒ íš¨ê³¼**

---

### **5) ì›ë³¸ ë°ì´í„° ë³µì› (ì¬êµ¬ì„±)**

```python
# PCAë¡œ ì°¨ì› ì¶•ì†Œëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ì›ë³¸ í˜•íƒœë¡œ ë³€í™˜
fruits_inverse = pca.inverse_transform(fruits_pca)

print(fruits_inverse.shape)  # (300, 10000)
```

**ì¶œë ¥ ê²°ê³¼**

```python
(300, 10000)
```

â†’ **50ê°œì˜ ì£¼ì„±ë¶„ë§Œ ì‚¬ìš©í–ˆì§€ë§Œ, ì›ë³¸ ë°ì´í„°ì™€ ìœ ì‚¬í•œ í˜•íƒœë¡œ ë³µì› ê°€ëŠ¥!**

- í•˜ì§€ë§Œ ì¼ë¶€ ì •ë³´ ì†ì‹¤ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ
- ì°¨ì› ì¶•ì†Œ í›„ì—ë„ ë°ì´í„°ë¥¼ ìµœëŒ€í•œ ìœ ì§€í•˜ëŠ” ê²ƒì´ PCAì˜ í•µì‹¬ ëª©í‘œ

---

### **6) ì›ë³¸ vs ì¬êµ¬ì„± ë°ì´í„° ë¹„êµ**

```python
# ë³µì›ëœ ë°ì´í„° ì‹œê°í™”
fruits_reconstruct = fruits_inverse.reshape(-1, 100, 100)

for start in [0, 100, 200]:  # 3ê°€ì§€ ìƒ˜í”Œ ë¹„êµ
    draw_fruits(fruits_reconstruct[start:start+100])
    print("\n")
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.41.57.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.41.57.png)

- **ì›ë³¸ ë°ì´í„°ì™€ ìœ ì‚¬í•œ ê³¼ì¼ ì´ë¯¸ì§€ë“¤ì´ ì¬êµ¬ì„±ë¨**
- ì¼ë¶€ ë¸”ëŸ¬(Blur) í˜„ìƒì´ ë°œìƒí•˜ì§€ë§Œ, ë°ì´í„°ì˜ í•µì‹¬ ì •ë³´ëŠ” ìœ ì§€ë¨

---

## **4. PCAì˜ ì„¤ëª…ëœ ë¶„ì‚° (Explained Variance)**

```python
print(np.sum(pca.explained_variance_ratio_))  # ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ ì¶œë ¥
```

**ì¶œë ¥ ê²°ê³¼**

```python
0.9215298262612741
```

- **92%ì˜ ë°ì´í„° ì •ë³´ë¥¼ ìœ ì§€í•œ ìƒíƒœì—ì„œ ì°¨ì› ì¶•ì†Œ ì„±ê³µ**

### **ì„¤ëª…ëœ ë¶„ì‚° ê·¸ë˜í”„ ì‹œê°í™”**

```python
plt.plot(pca.explained_variance_ratio_)
plt.show()
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-08 á„‹á…©á„’á…® 2.43.20.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-08_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.43.20.png)

- **ì²« 10ê°œ ì£¼ì„±ë¶„ì´ ëŒ€ë¶€ë¶„ì˜ ë¶„ì‚°ì„ ì„¤ëª…í•˜ê³  ìˆìŒ**
- ë¶ˆí•„ìš”í•œ íŠ¹ì„±ì„ ì œê±°í•˜ë©´ì„œë„ **ë°ì´í„° ì •ë³´ ì†ì‹¤ì„ ìµœì†Œí™”**

---

## **5. PCA + ë¶„ë¥˜ ëª¨ë¸ ì ìš© (Logistic Regression)**

PCAë¥¼ í™œìš©í•´ ì°¨ì›ì„ ì¤„ì¸ ë°ì´í„°ë¡œ **ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression) ëª¨ë¸ì„ í•™ìŠµ**

### **1) íƒ€ê²Ÿ ë°ì´í„° ìƒì„±**

```python
from sklearn.linear_model import LogisticRegression

# ì‚¬ê³¼=0, íŒŒì¸ì• í”Œ=1, ë°”ë‚˜ë‚˜=2 ë¼ë²¨ë§
target = np.array([0]*100 + [1]*100 + [2]*100)

# ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ ìƒì„±
lr = LogisticRegression()
```

---

### **2) ì›ë³¸ ë°ì´í„° í•™ìŠµ (êµì°¨ ê²€ì¦)**

```python
from sklearn.model_selection import cross_validate

# ì›ë³¸ ë°ì´í„°(10,000ì°¨ì›)ë¡œ êµì°¨ ê²€ì¦ ìˆ˜í–‰
scores = cross_validate(lr, fruits_2d, target)

# ì •í™•ë„ ì¶œë ¥
print(np.mean(scores['test_score']))
print(np-mean(scores['fit_time']))
```

**ì¶œë ¥ ê²°ê³¼**

```python
0.9966666666666667
0.9422160625457764
```

â†’ **ê³ ì°¨ì› ë°ì´í„°(10,000ì°¨ì›)ë¡œ í•™ìŠµí•˜ë©´ ë§¤ìš° ë†’ì€ ì„±ëŠ¥ì´ ë‚˜ì˜´!**

---

### **3) PCA ë°ì´í„° í•™ìŠµ (êµì°¨ ê²€ì¦)**

```python
# PCA ë³€í™˜ëœ ë°ì´í„°(50ì°¨ì›)ë¡œ í•™ìŠµ
scores = cross_validate(lr, fruits_pca, target)

# ì •í™•ë„ ì¶œë ¥
print(np.mean(scores['test_score']))
print(np.mean(scores[' fit_time']))
```

**ì¶œë ¥ ê²°ê³¼**

```python
1.0
0.03256878852844238
```

â†’ **50ê°œ ì£¼ì„±ë¶„ë§Œ ì‚¬ìš©í•´ë„ 100% ì •í™•ë„ ë‹¬ì„±!**

---

â†’ **ì°¨ì› ì¶•ì†Œë¥¼ í†µí•´ ë°ì´í„° íš¨ìœ¨ì„±ì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆìŒ

ì£¼ì„±ë¶„ì„ ì°¾ë„ë¡ í•˜ëŠ” PCA ëª¨ë¸**

```python
pca = PCA(n_components=0.5) # ì„¤ëª…ëœ ë¶„ì‚°(variance)ì˜ 50%ë¥¼ ìœ ì§€í•˜ëŠ” ì£¼ì„±ë¶„ ê°œìˆ˜ ìë™ ì„ íƒ
pca. fit(fruits_2d) #  PCA ëª¨ë¸ì„ ë°ì´í„°ì— ë§ì¶° í•™ìŠµ

print(pca.n_components_) # **ìµœì ì˜ ì£¼ì„±ë¶„ ê°œìˆ˜ë¥¼ ìë™ìœ¼ë¡œ ì°¾ì•„ ì¶œë ¥**
```

**ì¶œë ¥ ê²°ê³¼** 

```python
2
```

- **50%ì˜ ë¶„ì‚°ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ì£¼ì„±ë¶„ ê°œìˆ˜ 2ê°œë¥¼ ì„ íƒí•¨**
- **ì¦‰, ë°ì´í„°ì˜ ì°¨ì›ì„ 2ê°œë¡œ ì¶•ì†Œí•˜ì—¬ ì›ë³¸ ì •ë³´ë¥¼ ìµœëŒ€í•œ ìœ ì§€í•˜ë„ë¡ ë³€í™˜ë¨**

---

**ì›ë³¸ ë°ì´í„°ë¥¼ ì£¼ì„±ë¶„ ê³µê°„ìœ¼ë¡œ ë³€í™˜**

```python
fruits_pca = pca. transform(fruits_2d) # **ì›ë³¸ ë°ì´í„°ë¥¼ PCA ë³€í™˜í•˜ì—¬ ì°¨ì›ì„ ì¶•ì†Œ**
print(fruits_pca.shape) # **ë³€í™˜ëœ ë°ì´í„°ì˜ í¬ê¸° ì¶œë ¥**
```

ì¶œë ¥ ê²°ê³¼

```python
(300, 2)
```

- **300ê°œì˜ ìƒ˜í”Œì´ ì´ì œ 2ê°œì˜ ì°¨ì›ìœ¼ë¡œ í‘œí˜„ë¨**
- **ì›ë˜ (300, 10000)ì˜ ë°ì´í„°ê°€ (300, 2)ë¡œ ì¤„ì–´ë“¤ì–´ ì—°ì‚°ëŸ‰ì´ í¬ê²Œ ê°ì†Œ**

---

**êµì°¨ ê²€ì¦ì„ í†µí•œ ëª¨ë¸ ì„±ëŠ¥ í‰ê°€**

```python
scores = cross_validate(lr, fruits_pca, target) # ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression) ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦ ìˆ˜í–‰
print(np.mean(scores['test_score'])) # êµì°¨ ê²€ì¦ì—ì„œ ëª¨ë¸ì˜ í‰ê·  ì •í™•ë„ ì¶œë ¥
print(np.mean(scores['fit_time'])) # ëª¨ë¸ í•™ìŠµì— ê±¸ë¦° í‰ê·  ì‹œê°„ ì¶œë ¥
```

**ì¶œë ¥ ê²°ê³¼**

```python
0.9933333333333334
0.04122166633605957
```

- **PCAë¥¼ ì‚¬ìš©í•˜ì—¬ ì°¨ì›ì„ ì¤„ì˜€ìŒì—ë„ ëª¨ë¸ ì •í™•ë„ê°€ 99.3%ë¡œ ë§¤ìš° ë†’ìŒ**
- **ëª¨ë¸ í•™ìŠµ ì†ë„(`fit_time`)ë„ 0.04ì´ˆë¡œ ë§¤ìš° ë¹¨ë¼ì§ â†’ ì›ë³¸ ë°ì´í„°ë³´ë‹¤ ë¹ ë¥´ê²Œ í•™ìŠµ ê°€ëŠ¥**

---

## **6. PCA + K-Means êµ°ì§‘í™” ì ìš©**

```python
from sklearn.cluster import KMeans

# K-í‰ê·  í´ëŸ¬ìŠ¤í„°ë§ ì ìš© (ì°¨ì› ì¶•ì†Œëœ ë°ì´í„° ì‚¬ìš©)
km = KMeans(n_clusters=3, random_state=42)
km.fit(fruits_pca)

print(np.unique(km.labels_, return_counts=True))  # í´ëŸ¬ìŠ¤í„°ë³„ ìƒ˜í”Œ ê°œìˆ˜ í™•ì¸
```

**ì¶œë ¥ ê²°ê³¼**

```python
(array([0, 1, 2]), array([91, 99, 110]))
```

â†’ **PCAë¥¼ ì ìš©í•œ ë°ì´í„°ì—ì„œë„ K-Meansê°€ ì •í™•í•˜ê²Œ ê³¼ì¼ì„ êµ°ì§‘í™”í•¨!**

---

**êµ°ì§‘í™”ëœ ì´ë¯¸ì§€ ì¶œë ¥**

```python
for label in range(0, 3):
draw_fruits(fruits[km. labels_ == label])
# draw_fruits() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ **ê° í´ëŸ¬ìŠ¤í„°ë³„ ì´ë¯¸ì§€ë¥¼ ì¶œë ¥
#** km.labels_ == labelì„ ì‚¬ìš©í•˜ì—¬ **ê° êµ°ì§‘ì— ì†í•˜ëŠ” ê³¼ì¼ ì´ë¯¸ì§€ë¥¼ í•„í„°ë§**

print("\n")
```

ì¶œë ¥ ê²°ê³¼

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-09 á„‹á…©á„Œá…¥á†« 11.31.31.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-09_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.31.31.png)

- **ì™¼ìª½**: ë™ê·¸ë€ í˜•íƒœ â†’ ì‚¬ê³¼(apple)
- **ê°€ìš´ë°**: ê¸¸ì­‰í•œ ëª¨ì–‘ â†’ ë°”ë‚˜ë‚˜(banana)
- **ì˜¤ë¥¸ìª½**: ë‘¥ê¸€ì§€ë§Œ ê±°ì¹œ í‘œë©´ â†’ íŒŒì¸ì• í”Œ(pineapple)

---

**êµ°ì§‘í™”ëœ ë°ì´í„° ì‚°ì ë„ ì¶œë ¥**

```python
# K-Means ê²°ê³¼ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ ê° êµ°ì§‘ì„ ìƒ‰ìƒë³„ë¡œ êµ¬ë¶„
for Label in range(@, 3):
	data = fruits_pcalkm.labels_== LabeL]
	plt.scatter(data[:,0], data[:,1]) # PCAë¡œ ë³€í™˜ëœ 2ì°¨ì› ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ scatter()ë¡œ ì‚°ì ë„ í”Œë¡¯

plt. legend(['apple', 'banana', 'pineapple']) # legend()ë¥¼ ì‚¬ìš©í•´ êµ°ì§‘ë³„ ë¼ë²¨(ì‚¬ê³¼, ë°”ë‚˜ë‚˜, íŒŒì¸ì• í”Œ) ì¶”ê°€
plt. show()
```

**ì¶œë ¥ ê²°ê³¼**

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-02-09 á„‹á…©á„Œá…¥á†« 11.32.09.png](%E1%84%80%E1%85%B5%E1%84%80%E1%85%A8%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%206%E1%84%8C%E1%85%AE%E1%84%8E%E1%85%A1%2019477f5ae6fa80deaa7af802ce48d67e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-02-09_%E1%84%8B%E1%85%A9%E1%84%8C%E1%85%A5%E1%86%AB_11.32.09.png)

```python
scores = cross_validate(Ir, fruits_pca, target) # 
print(np.mean(scores[ test_score ] ) )
print(np.mean(scores['fit_time']))
```

- **ì°¨ì› ì¶•ì†Œ í›„ì—ë„ K-Meansê°€ ê³¼ì¼ì„ ì •í™•íˆ ë¶„ë¥˜í–ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥**
- **PCAë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ê°€ 2ì°¨ì› ê³µê°„ì— ì˜ ì •ë¦¬ë¨ì„ ë³¼ ìˆ˜ ìˆìŒ**
    - **íŒŒë€ìƒ‰ ì  (apple)** â†’ **ì™¼ìª½ í•˜ë‹¨ì— ëª¨ì—¬ ìˆìŒ**
    - **ì£¼í™©ìƒ‰ ì  (banana)** â†’ **ì˜¤ë¥¸ìª½ì— ë„“ê²Œ ë¶„í¬**
    - **ì´ˆë¡ìƒ‰ ì  (pineapple)** â†’ **ì™¼ìª½ ìƒë‹¨ì— ìœ„ì¹˜**